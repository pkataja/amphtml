let currentYear=(new Date).getFullYear(),boatlist=new Array,csvData,csvHeader,tablejsonData,orcBoats=0,dhBoats=0,nsBoats=0,tableBoats=0;async function fetchData(a){var t="https://data.orc.org/public/WPub.dll?action=DownRMS&CountryId=FIN&ext=json&VPPYear="+currentYear+"&family=";try{for(var n of[1,3,5])await getJsonData(await fetch(t+n),n);var i=await(await fetch("https://ampranking.s3.eu-north-1.amazonaws.com/2025/FinnishClass.json")).json();tablejsonData=Array.from(i.rms.entries()),await getCVSData(await fetch("https://ampranking.s3.eu-north-1.amazonaws.com/2025/FIN_table25.csv")),a()}catch(a){console.error("AJAX Request Failed:",a)}}async function getCVSData(a){a=await a.text();(csvData=Papa.parse(a)).data.forEach(function(n,i){if(0<i&&""!=n[0]){var _=new Map;let a=n[0],t=a.replace(".dxt","");var s=tablejsonData.find(([,a])=>a.BIN===t)[1];_.FIN_FinRating_TOT=s.FIN_FinRating_TOT,_.FIN_FinRating_H_TOT=s.FIN_FinRating_H_TOT,_.FIN_FinRating_L_TOT=s.FIN_FinRating_L_TOT,_.CDL=s.CDL,_.FIN_FinRating_TOD=s.FIN_FinRating_TOD,_.FIN_FinRating_H_TOD=s.FIN_FinRating_H_TOD,_.FIN_FinRating_L_TOD=s.FIN_FinRating_L_TOD,a=n[11],_.CrewWT=a.trim(),_.C_TYPE="TABLE",a=n[2],_.TYPE=a.trim(),_.FILE_ID=n[0],_.SAILNUMB="",_.NAME="",_.index=i,boatlist.push(_),n.push(_.FIN_FinRating_TOT),n.push(_.FIN_FinRating_H_TOT),n.push(_.FIN_FinRating_L_TOT),n.push(_.CDL),n.push(_.FIN_FinRating_TOD),n.push(_.FIN_FinRating_H_TOD),n.push(_.FIN_FinRating_L_TOD)}0===i&&(n.push("FIN_FinRating_TOT"),n.push("FIN_FinRating_H_TOT"),n.push("FIN_FinRating_L_TOT"),n.push("CDL"),n.push("FIN_FinRating_TOD"),n.push("FIN_FinRating_H_TOD"),n.push("FIN_FinRating_L_TOD"),csvHeader=n)}),tableBoats=csvData.data.length-1}async function getJsonData(a,t){a=await a.json();a.rms.forEach(a=>{var t=new Map;t.FIN_FinRating_TOT=a.FIN_FinRating_TOT,t.FIN_FinRating_H_TOT=a.FIN_FinRating_H_TOT,t.FIN_FinRating_L_TOT=a.FIN_FinRating_L_TOT,t.CDL=a.CDL,t.CrewWT=a.CrewWT,t.C_TYPE=a.C_Type;let n=a.Class;t.TYPE=n.trim(),t.FILE_ID=a.RefNo,n=a.SailNo,t.SAILNUMB=n.trim(),n=a.YachtName,t.NAME=n.trim(),boatlist.push(t)}),1===t&&(orcBoats=a.rms.length),3===t&&(dhBoats=a.rms.length),5===t&&(nsBoats=a.rms.length)}function output(){csvData.data.forEach(function(a,t){a.splice(0,1,"TABLE")}),boatlist.forEach(function(t,a,n){var i=new Array;if("TABLE"!=t.C_TYPE){i.push(t.C_TYPE),i.push(t.FIN_FinRating_TOT),i.push(t.FIN_FinRating_L_TOT),i.push(t.FIN_FinRating_H_TOT),i.push(t.CDL),i.push(t.CrewWT),i.push(t.TYPE),i.push(t.FILE_ID),i.push(t.SAILNUMB),i.push(t.NAME);let a=94;for(;0<--a;)i.push("");csvData.data.push(i)}}),csvData.data.forEach(function(a,t){103==a.length&&console.log(a.join(";"))})}